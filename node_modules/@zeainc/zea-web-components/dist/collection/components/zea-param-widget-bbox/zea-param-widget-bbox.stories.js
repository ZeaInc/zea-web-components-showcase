import { storiesOf } from '@storybook/html'

storiesOf('Components/zea-param-widget-bbox', module).add('Default', () => {
  const { Box3, Parameter } = globalThis.zeaEngine
  const value = new Box3()
  value.p0.set(1, 2, 3)
  value.p1.set(4, 5, 6)

  const parameter = new Parameter('Box3Parameter', value, 'Box3')
  const paramWidget = document.createElement('zea-param-widget-bbox')
  paramWidget.parameter = parameter

  setTimeout(() => {
    value.p0.set(10, 20, 30)
    value.p1.set(40, 50, 60)
    parameter.setValue(value)
  }, 5000)

  if (globalThis.zeaUx) {
    const { UndoRedoManager } = globalThis.zeaUx
    const undoRedoManager = UndoRedoManager.getInstance()

    document.addEventListener('keydown', (e) => {
      if ((e.metaKey || e.ctrlKey) && e.key === 'z') {
        console.log('Undo')
        undoRedoManager.undo()
      } else if ((e.metaKey || e.ctrlKey) && e.key === 'y') {
        console.log('Redo')
        undoRedoManager.redo()
      }
    })
  }

  return paramWidget
})
